// 


#include "StatusEffect_DodgeInvulnerability.h"

#include "HonkDuckAges/Player/HDAPlayerCharacter.h"
#include "HonkDuckAges/Shared/Components/HDALifeStateComponent.h"


UStatusEffect_DodgeInvulnerability::UStatusEffect_DodgeInvulnerability()
{
	EffectScope = EStatusEffectScope::PerTarget;
	bIsInfinite = true;
	bIsStackable = false;
	EffectType = EStatusEffectType::Buff;
}

bool UStatusEffect_DodgeInvulnerability::CanBeActivated_Implementation()
{
	const AHDAPlayerCharacter* PlayerCharacter = Cast<AHDAPlayerCharacter>(GetTargetActor());
	DamageManagerComponent = GetTargetActor()->GetComponentByClass<UHDALifeStateComponent>();
	return IsValid(PlayerCharacter) && DamageManagerComponent.IsValid();
}

void UStatusEffect_DodgeInvulnerability::ActivateEffect_Implementation()
{
	DamageManagerComponent->SetIsInvulnerable(true);
}

void UStatusEffect_DodgeInvulnerability::DeactivateEffect_Implementation(AActor* Deactivator)
{
	DamageManagerComponent->SetIsInvulnerable(false);
}
